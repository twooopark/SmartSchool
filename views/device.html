<div class="row">
  <div class="col-lg-12">
    <h1 class="page-header">디바이스 관리</h1>
  </div>
  <!-- /.col-lg-12 -->
</div>
<!-- /.row -->

<!--디바이스 리스트-->

<div class="row">
  <div class="col-lg-12">
    <div>
      <!-- /.panel-heading -->
      <table class="table table-striped table-bordered table-hover" width="100%" id="Device_dataTable">
        <thead>
          <tr>
            <th>번호</th>
            <th>이름</th>
            <th>설치위치</th>
            <th>최종교체일</th>
            <th>물리주소</th>
            <th>기타</th>
          </tr>
        </thead>
      </table>
    </div>
  </div>
</div>
<!-- /.row -->
<!-- /.row -->
<!--디바이스 정보 모달 시작-->
<div class="fade modal text-center" id="myModal_device_info" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
        <h4 class="modal-title" id="myModalLabel">디바이스 정보</h4>
      </div>
      <div class="modal-body text-danger">
        <div class="table-responsive">
          <table class="table table-striped table-bordered table-hover">
            <tbody>
              <!--tr>
                <td>ID</td>
                <td>D123456789</td>
              </tr>
              <tr>
                <td>종류</td>
                <td>스캔+센서</td>
              </tr>
              <tr>
                <td>설치위치</td>
                <td>3층 과학실</td>
              </tr>
              <tr>
                <td>최종교체일</td>
                <td>2017년 9월 1일</td>
              </tr>
              <tr>
                <td>동작상태</td>
                <td>작동중</td>
              </tr>
              <tr>
                <td>기타</td>
                <td>이곳에 위의 항목외에 알아두어야 할 내용이 있다면 기록합니다.</td>
              </tr-->
            </tbody>
          </table>
        </div>
        <!--일정 입력창 끝-->
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-target="#myModal_device_info_edit" data-toggle="modal">정보수정</button>
        <button type="button" class="btn btn-default" data-target="#myModal_device_info_del" data-toggle="modal">삭제</button>
        <button type="button" class="btn btn-primary" data-dismiss="modal">취소</button>
      </div>
    </div>
    <!-- /.modal-content -->
  </div>
  <!-- /.modal-dialog -->
</div>
<!--디바이스 정보 수정 모달창 시작-->
<div class="fade modal text-center" id="myModal_device_info_edit" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
        <h4 class="modal-title" id="myModalLabel">디바이스 정보 수정</h4>
      </div>
      <div class="modal-body text-danger">
        <div class="table-responsive">
          <table class="table table-striped table-bordered table-hover">
            <tbody>
              <tr>
                <td>ID</td>
                <td>
                  <input class="form-control" placeholder="" type="text">
                </td>
              </tr>
              <tr>
                <td>종류</td>
                <td>
                  <select class="form-control">
                    <option>스캔</option>
                    <option>스캔+센서</option>
                  </select>
                </td>
              </tr>
              <tr>
                <td>설치위치</td>
                <td>
                  <table class="">
                    <tbody>
                      <tr>
                        <td>
                          <select class="form-control">
                            <option>1층</option>
                            <option>2층</option>
                            <option>3층</option>
                            <option>4층</option>
                            <option>5층</option>
                            <option>옥상</option>
                          </select>
                        </td>
                        <td>&nbsp;&nbsp;</td>
                        <td>
                          <select class="form-control">
                            <option>1</option>
                            <option>2</option>
                            <option>3</option>
                            <option>4</option>
                            <option>5</option>
                            <option>6</option>
                          </select>
                        </td>
                        <td>학년&nbsp;&nbsp;</td>
                        <td>
                          <select class="form-control">
                            <option>1</option>
                            <option>2</option>
                            <option>3</option>
                            <option>4</option>
                            <option>5</option>
                            <option>6</option>
                            <option>7</option>
                            <option>8</option>
                            <option>9</option>
                            <option>10</option>
                            <option>11</option>
                            <option>12</option>
                            <option>13</option>
                            <option>14</option>
                            <option>15</option>
                            <option>16</option>
                            <option>17</option>
                            <option>18</option>
                            <option>19</option>
                            <option>20</option>
                            <option>21</option>
                            <option>22</option>
                            <option>23</option>
                            <option>24</option>
                            <option>25</option>
                            <option>26</option>
                            <option>27</option>
                            <option>28</option>
                            <option>29</option>
                            <option>30</option>
                          </select>
                        </td>
                        <td>반</td>
                      </tr>
                    </tbody>
                  </table>
                </td>
              </tr>
              <tr>
                <td>최종교체일</td>
                <td>
                  <table class="">
                    <tbody>
                      <tr>
                        <td>
                          <select class="form-control">
                            <option>2017</option>
                            <option>2018</option>
                            <option>2019</option>
                            <option>2020</option>
                            <option>2021</option>
                            <option>2022</option>
                            <option>2023</option>
                            <option>2024</option>
                            <option>2025</option>
                            <option>2026</option>
                            <option>2027</option>
                            <option>2028</option>
                          </select>
                        </td>
                        <td>년</td>
                        <td>
                          <select class="form-control">
                            <option>1</option>
                            <option>2</option>
                            <option>3</option>
                            <option>4</option>
                            <option>5</option>
                            <option>6</option>
                            <option>7</option>
                            <option>8</option>
                            <option>9</option>
                            <option>10</option>
                            <option>11</option>
                            <option>12</option>
                          </select>
                        </td>
                        <td>월</td>
                        <td>
                          <select class="form-control">
                            <option>1</option>
                            <option>2</option>
                            <option>3</option>
                            <option>4</option>
                            <option>5</option>
                            <option>6</option>
                            <option>7</option>
                            <option>8</option>
                            <option>9</option>
                            <option>10</option>
                            <option>11</option>
                            <option>12</option>
                            <option>13</option>
                            <option>14</option>
                            <option>15</option>
                            <option>16</option>
                            <option>17</option>
                            <option>18</option>
                            <option>19</option>
                            <option>20</option>
                            <option>21</option>
                            <option>22</option>
                            <option>23</option>
                            <option>24</option>
                            <option>25</option>
                            <option>26</option>
                            <option>27</option>
                            <option>28</option>
                            <option>29</option>
                            <option>30</option>
                            <option>31</option>
                          </select>
                        </td>
                        <td>일</td>
                      </tr>
                    </tbody>
                  </table>
                </td>
              </tr>
              <tr>
                <td>동작상태</td>
                <td>
                  <select class="form-control">
                    <option>작동중</option>
                    <option>정지</option>
                    <option>사용금지</option>
                  </select>
                </td>
              </tr>
              <tr>
                <td>기타</td>
                <td>
                  <input class="form-control" placeholder="" type="text">
                </td>
              </tr>
            </tbody>
          </table>
        </div>
        <!--일정 입력창 끝-->
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-target="#myModal_student_info_edit" data-toggle="modal">정보수정</button>
        <button type="button" class="btn btn-primary" data-dismiss="modal">취소</button>
      </div>
    </div>
    <!-- /.modal-content -->
  </div>
  <!-- /.modal-dialog -->
</div>
<!--디바이스 등록 모달창 시작-->
<div class="fade modal text-center" id="myModal_device_new" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
        <h4 class="modal-title" id="myModalLabel">디바이스 등록</h4>
      </div>
      <div class="modal-body text-danger">
        <div class="table-responsive">
          <table class="table table-striped table-bordered table-hover">
            <tbody>
              <tr>
                <td>ID</td>
                <td>
                  <input class="form-control" placeholder="" type="text">
                </td>
              </tr>
              <tr>
                <td>종류</td>
                <td>
                  <select class="form-control">
                    <option>스캔</option>
                    <option>스캔+센서</option>
                  </select>
                </td>
              </tr>
              <tr>
                <td>설치위치</td>
                <td>
                  <table class="">
                    <tbody>
                      <tr>
                        <td>
                          <select class="form-control">
                            <option>1층</option>
                            <option>2층</option>
                            <option>3층</option>
                            <option>4층</option>
                            <option>5층</option>
                            <option>옥상</option>
                          </select>
                        </td>
                        <td>&nbsp;&nbsp;</td>
                        <td>
                          <select class="form-control">
                            <option>1</option>
                            <option>2</option>
                            <option>3</option>
                            <option>4</option>
                            <option>5</option>
                            <option>6</option>
                          </select>
                        </td>
                        <td>학년&nbsp;&nbsp;</td>
                        <td>
                          <select class="form-control">
                            <option>1</option>
                            <option>2</option>
                            <option>3</option>
                            <option>4</option>
                            <option>5</option>
                            <option>6</option>
                            <option>7</option>
                            <option>8</option>
                            <option>9</option>
                            <option>10</option>
                            <option>11</option>
                            <option>12</option>
                            <option>13</option>
                            <option>14</option>
                            <option>15</option>
                            <option>16</option>
                            <option>17</option>
                            <option>18</option>
                            <option>19</option>
                            <option>20</option>
                            <option>21</option>
                            <option>22</option>
                            <option>23</option>
                            <option>24</option>
                            <option>25</option>
                            <option>26</option>
                            <option>27</option>
                            <option>28</option>
                            <option>29</option>
                            <option>30</option>
                          </select>
                        </td>
                        <td>반</td>
                      </tr>
                    </tbody>
                  </table>
                </td>
              </tr>
              <tr>
                <td>최종교체일</td>
                <td>
                  <table class="">
                    <tbody>
                      <tr>
                        <td>
                          <select class="form-control">
                            <option>2017</option>
                            <option>2018</option>
                            <option>2019</option>
                            <option>2020</option>
                            <option>2021</option>
                            <option>2022</option>
                            <option>2023</option>
                            <option>2024</option>
                            <option>2025</option>
                            <option>2026</option>
                            <option>2027</option>
                            <option>2028</option>
                          </select>
                        </td>
                        <td>년</td>
                        <td>
                          <select class="form-control">
                            <option>1</option>
                            <option>2</option>
                            <option>3</option>
                            <option>4</option>
                            <option>5</option>
                            <option>6</option>
                            <option>7</option>
                            <option>8</option>
                            <option>9</option>
                            <option>10</option>
                            <option>11</option>
                            <option>12</option>
                          </select>
                        </td>
                        <td>월</td>
                        <td>
                          <select class="form-control">
                            <option>1</option>
                            <option>2</option>
                            <option>3</option>
                            <option>4</option>
                            <option>5</option>
                            <option>6</option>
                            <option>7</option>
                            <option>8</option>
                            <option>9</option>
                            <option>10</option>
                            <option>11</option>
                            <option>12</option>
                            <option>13</option>
                            <option>14</option>
                            <option>15</option>
                            <option>16</option>
                            <option>17</option>
                            <option>18</option>
                            <option>19</option>
                            <option>20</option>
                            <option>21</option>
                            <option>22</option>
                            <option>23</option>
                            <option>24</option>
                            <option>25</option>
                            <option>26</option>
                            <option>27</option>
                            <option>28</option>
                            <option>29</option>
                            <option>30</option>
                            <option>31</option>
                          </select>
                        </td>
                        <td>일</td>
                      </tr>
                    </tbody>
                  </table>
                </td>
              </tr>
              <tr>
                <td>동작상태</td>
                <td>
                  <select class="form-control">
                    <option>작동중</option>
                    <option>정지</option>
                    <option>사용금지</option>
                  </select>
                </td>
              </tr>
              <tr>
                <td>기타</td>
                <td>
                  <input class="form-control" placeholder="" type="text">
                </td>
              </tr>
            </tbody>
          </table>
        </div>
        <!--일정 입력창 끝-->
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-target="#myModal_student_info_edit" data-toggle="modal">확인</button>
        <button type="button" class="btn btn-primary" data-dismiss="modal">취소</button>
      </div>
    </div>
    <!-- /.modal-content -->
  </div>
  <!-- /.modal-dialog -->
</div>
<div class="fade modal text-center" id="myModal_device_info_del" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
        <h4 class="modal-title" id="myModalLabel">디바이스 정보를 삭제하시겠습니까.</h4>
      </div>
      <div class="modal-body text-danger">
        <p class="text-muted">삭제된 디바이스의 데이터도 같이 삭제가 됩니다.</p>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">확인</button>
        <button type="button" class="btn btn-primary" data-dismiss="modal">취소</button>
      </div>
    </div>
    <!-- /.modal-content -->
  </div>
  <!-- /.modal-dialog -->
</div>


<!--교실명 수정 모달창 끝-->
<script>  
var D_dTable ,d;
$(document).ready(function(){
  D_dTable = $('#Device_dataTable').DataTable({
    "info"        : false,
    "searching"   : true,
    "lengthChange": false,
    "processing"  : false,
    "order"       : [[ 2, "asc" ]],
    "ajax"        : {
        "url"     : "api/device-data",
        "dataSrc" : ""
    },
    "columns"  : [ {
        "data" : "no"
    },{
        "data" : "device_name"
    },{
        "data" : "loc"
    }, {
        "data" : "replaced_date"
    }, {
        "data" : "mac"
    }, {
        "data" : "description"
    }],
    "dom"     : 'Bfrtip',
    "buttons" : [
      {  
          text: '디바이스 등록',
          action: function ( e, dt, node, config ) {
              $('#myModal_device_new').modal('show')
          },
          className: 'btn  btn-default my-class-button'
      }
    ]
  });

  $('#Device_dataTable').on('init.dt', function() {
     $('.my-text-button') 
       .attr('data-toggle', 'modal')
       .attr('data-target', '#myModal_device_info');  
  });

  $('#Device_dataTable tbody').on('click', 'tr', function (){
    var d_dData = D_dTable.row(this).data();
    dData.d_name = d_dData.device_name;
    $("#myModal_device_info").modal();
    $("#myModal_device_info .modal-title").text(dData.d_name+" - 디바이스 정보")
    D_DataReload(dData);
  });
});


function D_DataReload(formData){
  $.ajax({ 
    url : "/api/device-data",
    type: "POST",
    data: dData,
    dataType: 'json',
    success: function(result){
      data = result;
      var tbl_body = "";
      $.each(data, function() {
        var tbl_row = "";
        $.each(this, function(k , v) {
         tbl_row += "<td id=\""+k+"\">"+v+"</td>";
        })
        tbl_body += "<tr>"+tbl_row+"</tr>";
      })
      $("#Device_dataTable tbody").html(tbl_body);
    }, 
    error: function(xhr, option, error){
      alert(xhr.status); 
      alert(error);
    }
  });
}

</script>